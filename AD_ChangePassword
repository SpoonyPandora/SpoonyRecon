###This script will allow you to change password of target user without RSAT. It takes advantage of the ADSI type accelerator for searching usernames and changing password values.

###Initialization variables (domain, target user, etc.)

$domain = Read-Host "Input domain:"
$user = Read-Host "Input username:"
$old_Pass = Read-Host -AsSecureString "Input old password:"
$new_Pass = Read-Host -AsSecureString "Input new password:"
$confirm_new_Pass = Read-Host -AsSecureString "Confirm new password:"

###Check that new password input matches confirmation, exit if they do not match.

Write-Host "Confirming password values match..."
if ($new_pass != $confirm_new_Pass) {
  Exit}
else {
  Write-Host "Values match, requesting password change..."

###Check for existence of user and if it doesn't exist, err and exit. If user exists, initialize ADSI object and utilze the ChangePassword function to swap oldPass with newPass.

$verify_User = [asdisearcher]"(&objectClass=user)(ObjectCategory=person)(userPrincipalName=$user))"
If(-Not $verify_User) {
  Write-Host "User not found, exiting..."
  Exit}
Else {
  [adsi]"WinNT://$domain/$user".ChangePassword('$old_Pass','new_Pass')
  Write-Host "Password change for user $domain\$user successful!"
  Exit}

###ROADMAP/WISHLIST
#N/A
