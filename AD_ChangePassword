###This script will allow you to change password of target user without RSAT. It takes advantage of the ADSI type accelerator for searching usernames and changing password values.

###Initialization variables (domain, target user, etc.)

$domain = Read-Host "Input domain:"
$user = Read-Host "Input username:"
$old_Pass = Read-Host "Input old password:"
$new_Pass = Read-Host "Input new password:"

#Check for existence of user and if it doesn't exist, err and exit.
#If user exists, initialize ADSI object and utilze the ChangePassword function to swap oldPass with newPass.

$verify_User = [asdisearcher]"(&objectClass=user)(ObjectCategory=person)(userPrincipalName=$user))"
If(-Not $verify_User) {
  Write-Host "User not found, exiting..."}
Else {
  [adsi]"WinNT://$domain/$user".ChangePassword('$old_Pass','new_Pass')
  Write-Host "Password change for user $domain\\$user successful."}

###ROADMAP/WISHLIST
#Use secure-string function to remove plaintext input for sensitive values (though when used for living off the land this may not even matter)
